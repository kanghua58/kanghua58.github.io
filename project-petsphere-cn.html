<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
    <link rel="stylesheet" href="project-style.css" />
    <link rel="icon" href="./image/icon.png" />
    <title>KAY QIU | PETSPHERE</title>
  </head>

  <!-- Google tag (gtag.js) -->
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=G-K5BHE7RETG"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "G-K5BHE7RETG");
  </script>
  <body>
    <header>
      <span class="name">仇康化</span>
      <ul class="navbar">
        <li class="nav-item">
          <a href="index-cn.html#about" target="_blank">关于</a>
        </li>
        <li class="nav-item">
          <a href="index-cn.html#work" class="active-nav-item" target="_blank"
            >作品</a
          >
        </li>
        <li class="nav-item">
          <a href="https://kanguru.vercel.app" target="_blank">博客</a>
        </li>
        <li class="nav-item">
          <a href="./files/仇康化.pdf" target="_blank">简历</a>
        </li>
      </ul>
    </header>
    <div class="line">line</div>

    <main>
      <section id="description">
        PetSphere🐕是一个宠物社区社交网络应用,它连接着宠物主人和宠物服务提供者。
      </section>
      <section id="table-of-contents">
        <h2>目录</h2>
        <ol>
          <li><a href="#overview">概述</a></li>
          <li><a href="#role">角色</a></li>
          <li><a href="#01">1. 一个高度个性化的Web 3.5应用</a></li>
          <li><a href="#02">2. 响应式设计和极简UI</a></li>
          <li><a href="#03">3. 作为一名全栈开发者工作</a></li>
          <li><a href="#04">4. 实现网络分析</a></li>
        </ol>
      </section>
      <section id="meta-data">
        <div class="col4">
          <span class="highlight-pink">时间线 --</span> <br />
          3个月(2023年秋季)
        </div>
        <div class="col4 paddingside30">
          <span class="highlight-pink">角色 --</span> <br />概念原型设计 <br />
          UI设计 <br />
          前端开发 <br />
          后端开发
        </div>
        <div class="col4 paddingside30">
          <span class="highlight-pink">为了 --</span
          ><br />连接宠物主人与宠物社区/行业
        </div>
        <div class="col4">
          <span class="highlight-pink">合作 --</span><br />导师: Andrew Twigg
          <br />团队: Lucy Cao, Dhruvisha Mondhe
        </div>
      </section>
      <img
        class="overview-pic"
        src="./image/petsphere/overview_petsphere.png"
        alt=""
      />
      <section id="overview">
        <p class="highlight-pink">概述</p>
        <h1 class="descriptive-block">Web3.5社交网络应用</h1>
        <p>
          PetSphere是一个充满活力的宠物社区社交网络应用,旨在将宠物主人与服务提供者连接起来,为宠物爱好者营造一个充满活力的社区。该平台提供了一个全面的博客,用于分享想法,以及一个提供遛宠和宠物看护服务的平台,满足宠物主人的多样化需求。
        </p>
      </section>

      <section id="role">
        <p class="highlight-pink">角色</p>
        <h1 class="descriptive-block">UI设计师 & 全栈开发者</h1>
        <p>
          作为设计师和全栈开发者,我的角色涉及设计和开发PetSphere的用户体验和界面。我专注于开发响应式和直观的设计,集成了诸如延迟注册、个性化推荐和用户仪表板等功能。
        </p>
      </section>

      <section id="01">
        <h1 class="title-pink">1. 一个高度个性化的Web 3.5应用</h1>
        <div class="image-plus">
          <img class="col8" src="./image/petsphere/creating-post.gif" alt="" />
          <div class="col8 plus-description">
            <h1 class="descriptive-block">创建帖子</h1>
            <p>
              用户可以轻松创建和分享他们的宠物故事或建议。这个功能设计得非常直观,即使是最新手的用户也能轻松上手,鼓励大家积极贡献内容。
            </p>
          </div>
        </div>
        <div class="image-plus">
          <img class="col8" src="./image/petsphere/tagging.gif" alt="" />
          <div class="col8 plus-description">
            <h1 class="descriptive-block">标签</h1>
            <p>
              每个帖子都可以用相关的关键词标记,这样其他人就可以更容易地找到特定主题的内容,比如"狗狗美容"或"猫咪健康"。
            </p>
          </div>
        </div>
        <div class="image-plus">
          <img class="col8" src="./image/petsphere/liking.gif" alt="" />
          <div class="col8 plus-description">
            <h1 class="descriptive-block">点赞 & 通知</h1>
            <p>
              这个功能允许用户对他们认为有用或有趣的帖子点赞,帮助社区发现优质内容。当有人通过点赞/踩/标记与用户的帖子互动时,用户会收到通知。
            </p>
          </div>
        </div>
        <div class="image-plus">
          <img
            class="col8"
            src="./image/petsphere/searching + bookmarking.gif"
            alt=""
          />
          <div class="col8 plus-description">
            <h1 class="descriptive-block">搜索 & 收藏</h1>
            <p>
              用户可以使用关键词搜索内容/其他用户。标签用于扩展搜索结果。如果用户发现某些帖子有帮助,可以在用户仪表板上收藏这些帖子,方便将来参考。
            </p>
          </div>
        </div>
        <div class="image-plus">
          <img class="col8" src="./image/petsphere/recommendation.gif" alt="" />
          <div class="col8 plus-description">
            <h1 class="descriptive-block">个性化推荐系统</h1>
            <p>
              该系统根据个人用户的偏好和过去的互动记录推荐帖子,增强用户与相关内容的互动。
            </p>
          </div>
        </div>
      </section>

      <section id="02">
        <h1 class="title-pink">2. 响应式设计和极简UI</h1>
        <div class="image-plus">
          <div class="col8 plus-description">
            <h1 class="descriptive-block">响应式设计</h1>
            <p>
              PetSphere平台经过精心设计,在各种设备上都能提供一致且实用的体验——从台式机到智能手机。这种响应式设计方法确保网站能够根据不同设备的屏幕尺寸和分辨率调整其布局、图像和功能。
            </p>
          </div>
          <img
            class="col8"
            src="./image/petsphere/responsive design.gif"
            alt=""
          />
        </div>
        <div class="image-plus">
          <div class="col8 plus-description-left">
            <h1 class="descriptive-block">用户友好的界面</h1>
            <p>
              PetSphere的用户界面设计直观,易于导航,减少了新用户的学习曲线,提升了整体用户体验。关键信息呈现清晰,交互元素触手可及,让用户从发现内容到预订服务的过程变得简单而愉悦。
            </p>
          </div>
          <img class="col8" src="./image/petsphere/design-screens.png" alt="" />
        </div>
      </section>

      <section id="03">
        <h1 class="title-pink">3. 作为一名全栈开发者工作</h1>
        <p>
          PetSphere建立在现代web技术的坚实基础之上,确保无缝且安全的用户体验。我们的技术栈包括HTML、CSS、JavaScript、PHP、SQL、Ruby和Node.js,每一项都在我们平台的功能和美学方面发挥着至关重要的作用。
        </p>
        <div class="image-plus">
          <div class="col8 plus-description-left">
            <h1 class="descriptive-block">前端开发</h1>
            <p>
              在PetSphere的前端开发中,界面经过精心设计,以提供无缝的用户体验。利用HTML、CSS和JavaScript。例如,我使用HTML构建注册表单,确保每个输入字段都有清晰的标签和易于访问。表单的设计使用CSS进行了增强,使其具有视觉吸引力,并与PetSphere的整体美学保持一致。JavaScript用于前端验证,确保用户在提交表单之前正确输入所需信息。
            </p>
            <h1 class="descriptive-block paddingtop20">连接后端</h1>
            <p>
              PetSphere的后端在支持整个应用程序方面发挥着关键作用,确保高效的数据处理、安全性和与前端的无缝交互。我们采用了PHP、Node.js和SQL等技术的组合,创建了一个强大且可扩展的后端基础设施。例如,注册表单与后端集成,以处理用户注册。使用PHP和SQL,我们开发了一个安全高效的流程来存储用户数据。PHP中的后端脚本处理表单提交。它包括验证,以检查电子邮件是否已经注册,并在将密码存储到数据库之前对其进行加密。
            </p>
          </div>
          <img
            class="col6 fit-cover"
            src="./image/petsphere/signup.gif"
            alt=""
          />
        </div>

        <div class="descriptive-block">
          <pre><code class="language-html" style="font-family: 'DM Mono';">
  &lt;!-- Sample .html Code for Signup Interface Structure --&gt;

  &lt;!DOCTYPE html&gt;
  &lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;PetSphere | Sign-up&lt;/title&gt;
    &lt;link rel="stylesheet" href="./style.css" /&gt;
    &lt;style&gt;
              body {
                background-image: url("http://localhost/petsphere2/assets/images/backgrounds/bg_animal.jpeg");
                background-size: cover;
                background-repeat: no-repeat;
                background-position: center;
                background-attachment: fixed;
              }
          &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="popup-container"&gt;
      &lt;div class="signup"&gt;
        &lt;div class="logo-container"&gt;
          &lt;a href="./index.php"&gt;
            &lt;img class="logo" src="http://localhost/petsphere2/assets/images/icons/logo.png" alt=""/&gt;
          &lt;/a&gt;
        &lt;/div&gt;
        &lt;form action="signup.php" method="post"&gt;
          &lt;!-- user input username --&gt;
          &lt;div class="input-container"&gt;
            &lt;input type="text" name="username" value="" required /&gt;
            &lt;label for="username"&gt;Username&lt;/label&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
          &lt;/div&gt;

          &lt;div class="input-container"&gt;
            &lt;input type="email" name="email" value="" required /&gt;
            &lt;label for="email"&gt;Email&lt;/label&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
          &lt;/div&gt;

          &lt;div class="input-container"&gt;
            &lt;input type="password" name="password" required /&gt;
            &lt;label for="password"&gt;Password&lt;/label&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
          &lt;/div&gt;

          &lt;div class="input-container"&gt;
            &lt;input type="password" name="confirm_password" required /&gt;
            &lt;label for="confirm_password"&gt;Confirm Password&lt;/label&gt;
            &lt;div class="error-message"&gt;&lt;/div&gt;
          &lt;/div&gt;

          &lt;button class="popup-button" type="submit"&gt;Sign up&lt;/button&gt;
        &lt;/form&gt;
        &lt;p&gt;Have an account? &lt;a href="login.php" class="popup-link"&gt;Login&lt;/a&gt;&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/body&gt;
  &lt;/html&gt;
              </code></pre>

          <pre><code class="language-css">
    /* Sample .css Code for Login & Signup Interface */

    .error-message {
      font-size: 12px;
      padding-top: 2px;
      padding-left: 3px;
      margin-bottom: 0;
      padding-bottom: 0;
      color: var(--MAIN);
    }

    .popup-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: auto;
    }

    .login,
    .signup {
      position: fixed;
      top: 20vh;
      background-co/lor: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border: 1px solid #cccccc68;
      border-radius: 18px;
      width: 300px;
      padding: 50px;
    }

    .popup-container h2 {
      text-align: center;
      padding-bottom: 0;
      margin-bottom: 5px;
    }

    form .input-container {
      position: relative;
      margin-bottom: 20px;
      width: 100%;
    }

    .popup-container input {
      width: 100%;
      padding: 10px;
      padding-left: 10px;
      padding-right: 32px;
      border: 1px solid var(--GRAYLIGHT);
      border-radius: 10px;
      font-size: 1.05rem;
      font-family: "Karla";
    }

    .popup-container .login input {
      width: 85%;
    }

    .popup-container label {
      position: absolute;
      top: 22px;
      left: 10px;
      transform: translateY(-50%);
      pointer-events: none;
      color: var(--GRAY);
      transition: all 0.2s ease-in-out;
    }

    .popup-container input:focus + label {
      top: 0;
      left: 0;
      padding-bottom: 20px;
      font-size: 12px;
      color: var(--GRAY);
    }

    .popup-container input:valid + label {
      top: 0;
      left: 0;
      padding-bottom: 20px;
      font-size: 12px;
      color: var(--GRAY);
    }

    .popup-container p {
      text-align: center;
      padding-top: 20px;
    }

    .popup-link {
      color: var(--MAIN);
      text-decoration: underline;
    }
                </code></pre>

          <pre><code class="language-php">
    // Sample .php Code for Handling Signup

    &lt;?php
    $username = "";
    $email = "";
    $password = "";
    $confirm_password = "";
    $signup_date = date("Y-m-d"); 
    $profile_pic = "";
    $error_array = array(); 


    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        $username = $_POST["username"];
        $_SESSION["username"] = $username;

        $email = $_POST["email"];
        $_SESSION["email"] = $email;

        $password = $_POST["password"];
        $confirm_password = $_POST["confirm_password"];

        // verify username length
        if (strlen($username) &gt; 50 || strlen($username) &lt; 2) {
            array_push($error_array, "Username must be between 2 and 50 characters&lt;br&gt;");
        }

        // check if username already exists
        if ($stmt = $con-&gt;prepare("SELECT username FROM users WHERE username = ?")) {
            $stmt-&gt;bind_param("s", $username);
            $stmt-&gt;execute();
            $result = $stmt-&gt;get_result();
            $num_rows = $result-&gt;num_rows;
            $stmt-&gt;close();

            if ($num_rows &gt; 0) {
                array_push($error_array, "Username already exists&lt;br&gt;");
            }
        }



        // verify email address
        if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
            $email = filter_var($email, FILTER_VALIDATE_EMAIL);

            // prevent SQL injection
            $stmt = $con-&gt;prepare("SELECT email FROM users WHERE email = ?");
            $stmt-&gt;bind_param("s", $email);
            $stmt-&gt;execute();
            $result = $stmt-&gt;get_result();
            $num_rows = $result-&gt;num_rows;
            $stmt-&gt;close();

            if ($num_rows &gt; 0) {
                array_push($error_array, "Email already in use&lt;br&gt;");
            }
        } else {
            array_push($error_array, "Invalid email address&lt;br&gt;");
        }

        // verify password
        $password_valid = true;
        if (preg_match('/[^A-Za-z0-9]/', $password)) {
            array_push($error_array, "Your password can only contain English letters or numbers&lt;br&gt;");
            $password_valid = false;
        }
        
        if (strlen($password) &gt; 30 || strlen($password) &lt; 5) {
            array_push($error_array, "Your password must be between 5 and 30 characters&lt;br&gt;");
            $password_valid = false;
        }

        if ($password !== $confirm_password) {
            array_push($error_array, "Passwords did not match&lt;br&gt;");
            $password_valid = false;
        }

        // register new user if no errors
        if (empty($error_array) && $password_valid) {
            $hashed_password = password_hash($password, PASSWORD_DEFAULT);

            //profile picture assignment
            $rand = rand(1,3);

            if($rand == 1){
              $profile_pic = "http://localhost/petsphere2/assets/images/profile_pics/momo.jpeg";
            } else if ($rand == 2){
              $profile_pic = "http://localhost/petsphere2/assets/images/profile_pics/momo1.jpg";
            } else if ($rand == 3){
              $profile_pic = "http://localhost/petsphere2/assets/images/profile_pics/momo2.jpg";
            };
            
            // write the data into database
            $stmt = $con-&gt;prepare("INSERT INTO users (username, email, password, signup_date, profile_pic) VALUES (?, ?, ?, ?, ?)");
            $stmt-&gt;bind_param("sssss", $username, $email, $hashed_password, $signup_date, $profile_pic);
            
            if ($stmt-&gt;execute()) {
                echo "Welcome to PetSphere!&lt;br&gt;";
                $_SESSION["username"] = $username;
                header("Location: index.php");
                exit();

            } else {
                echo "Woops, Something went wrong: " . $con-&gt;error;
            }
            $stmt-&gt;close();
        }
    }
    $_SESSION['error_array'] = $error_array;
    ?&gt;

    &lt;script&gt;
        console.log($error_array)
    &lt;/script&gt;
                  </code></pre>
        </div>
      </section>

      <section id="04">
        <h1 class="title-pink">4. 数据分析</h1>
        <div class="image-plus">
          <div class="col8 plus-description">
            <h1 class="descriptive-block">用户行为分析</h1>
            <p>
              通过分析用户在平台上的行为，比如点赞、收藏、标签使用，我们可以了解到哪些内容更受大家的喜爱。这些数据将用于改进内容策略，为用户提供更多精彩实用的养宠知识和资讯，让每一个用户都能成为最棒的铲屎官。
            </p>
          </div>
          <div class="col8 plus-description">
            <h1 class="descriptive-block">个性化推荐算法</h1>
            <p>
              我使用了外部程序来分析用户行为并创建用户向量。这个算法会考虑用户点赞、收藏的帖子等因素，对未阅读的帖子进行排序，并按相关性推荐给用户。
            </p>
          </div>
        </div>

        <div class="descriptive-block">
          <pre><code class="language-ruby">
        # Sample .rb Code for Calculating Keywords
        
        require 'json'
        
        # parses the JSON data passed to the script
        input_json = ARGV[0]
        posts_data = JSON.parse(input_json)
        
        # initializes a hash table for keyword frequencies
        keyword_frequencies = Hash.new(0)
        
        # defines a method for basic text cleaning
        def clean_text(text)
          # basic cleaning: converts to lowercase and removes non-alphanumeric characters
          text.downcase.gsub(/[^a-z0-9\s]/i, '')
        end
        
        # Extended list of stopwords
        stopwords = %w[
          the and to of a in that is was it for on with as by he she they at be this have from or one had 
          by word but not what all were we when your can said there use an each which she do how their if 
          will up other about out many then them these so some her would make like him into time has look 
          two more write go see number no way could people my than first water been call who oil its now 
          find long down day did get come made may part over new sound take only little work know place 
          year live me back give most very after thing our just name good sentence man think say great 
          where help through much before line right too mean old any same tell boy follow came want show 
          also around form three small set put end does another well large must big even such because turn 
          here why ask went men read need land different home us move try kind hand picture again change 
          off play spell air away animal house point page letter mother answer found study still learn 
          should america world high every near add food between own below country plant last school father 
          keep tree never start city earth eye light thought head under story saw left few while 
          along might close something seem next hard open example begin life always those both paper 
          together got group often run important until children side feet car mile night walk white sea 
          began grow took river four carry state once book hear stop without second late miss idea enough 
          eat face watch far indian real almost let above girl sometimes mountains cut young talk soon list 
          song being leave family
        ]
        
        TITLE_TAG_WEIGHT = 100
        
        # iterates over post data, extracting and processing text
        posts_data.each do |post|
          # combines title, body, and tags
          combined_text = post['title'] + ' ' + post['body'] + ' ' + post['tags']
          cleaned_text = clean_text(combined_text)
        
          # splits the text into words and counts frequencies, skipping stopwords
          cleaned_text.split.each do |word|
            next if stopwords.include?(word) 
            keyword_frequencies[word] += 1
          end
        
          title_and_tags = post['title'] + ' ' + post['tags']
          cleaned_title_and_tags = clean_text(title_and_tags)
          cleaned_title_and_tags.split.each do |word|
            next if stopwords.include?(word)
            keyword_frequencies[word] += TITLE_TAG_WEIGHT
          end
        end
        
        # outputs the keyword frequencies in JSON format
        puts keyword_frequencies.to_json
            </code></pre>
          <pre><code class="language-php">
        // Sample .php Code for Creating User Vector and Getting Recommendation

        &lt;?php
    
        function fetchPostsLikedByUser($userId, $con) {
            $likedPostsData = [];
            $likedPostsQuery = mysqli_query($con, "SELECT post_id FROM likes WHERE username = '" . mysqli_real_escape_string($con, $userId) . "'");
            if (!$likedPostsQuery) {
                die('Query failed: ' . mysqli_error($con));
            }
            while ($row = mysqli_fetch_assoc($likedPostsQuery)) {
                $postId = $row['post_id'];
                $postQuery = mysqli_query($con, "SELECT title, body, tags FROM posts WHERE id = '$postId'");
                if ($postRow = mysqli_fetch_assoc($postQuery)) {
                    $likedPostsData[] = $postRow;
                }
            }
            return $likedPostsData;
        }
    
        function getKeywordFrequencies($postsData) {
            $rubyExecutable = '/usr/bin/ruby';
            $scriptPath = __DIR__ . '/../assets/ruby/process.rb';
            $command = $rubyExecutable . ' ' . escapeshellarg($scriptPath) . ' ' . escapeshellarg(json_encode($postsData)) . ' 2&gt;&amp;1';
            $output = shell_exec($command);
    
            if ($output === null) {
                die("Error: Ruby script did not return any output");
            }
    
            $decodedOutput = json_decode($output, true);
            if (json_last_error() !== JSON_ERROR_NONE) {
                die("Error processing posts data: " . $output . "\nJSON Error: " . json_last_error_msg());
            }
    
            return $decodedOutput;
        }
    
        function getRecommendations($userId, $con) {
        
            $likedPostsData = fetchPostsLikedByUser($userId, $con);
            
            if (empty($likedPostsData)) {
                $allPostsQuery = mysqli_query($con, "SELECT id FROM posts WHERE deleted='no' ORDER BY date_added DESC");
                $allPostsData = mysqli_fetch_all($allPostsQuery, MYSQLI_ASSOC);
                return array_column($allPostsData, 'id');
            }
        
            $keywordFrequencies = getKeywordFrequencies($likedPostsData);
            arsort($keywordFrequencies);
        
            $allPostsQuery = mysqli_query($con, "SELECT id, title, body, tags FROM posts WHERE deleted='no'");
            $allPostsData = mysqli_fetch_all($allPostsQuery, MYSQLI_ASSOC);
        
            usort($allPostsData, function ($post1, $post2) use ($keywordFrequencies, $userId, $con) {
                $score1 = calculatePostScore($post1, $keywordFrequencies);
                $score2 = calculatePostScore($post2, $keywordFrequencies);
        
                $liked1 = isLikedByUser($post1['id'], $userId, $con);
                $liked2 = isLikedByUser($post2['id'], $userId, $con);
        
                if ($liked1 == $liked2) {
                    return $score2 &lt;=&gt; $score1;
                }
        
                return $liked1 ? 1 : -1;
            });
        
            return array_column($allPostsData, 'id');
        }
    
        function isLikedByUser($postId, $userId, $con) {
            $likeQuery = mysqli_query($con, "SELECT * FROM likes WHERE post_id='$postId' AND username='" . mysqli_real_escape_string($con, $userId) . "'");
            return mysqli_num_rows($likeQuery) &gt; 0;
        }
        
    
        function calculatePostScore($post, $keywordFrequencies) {
            $combinedText = $post['title'] . ' ' . $post['body'] . ' ' . $post['tags'];
            $words = explode(' ', $combinedText);
            $score = 0;
    
            foreach ($words as $word) {
                if (isset($keywordFrequencies[$word])) {
                    $score += $keywordFrequencies[$word];
                }
            }
    
            return $score;
        }
    
        if (isset($userLoggedIn)) {
            // get list of posts based on recommendation algorithm
            $recommendations = getRecommendations($userLoggedIn, $con);
            $postIds = implode(',', $recommendations);
            $postQuery = "SELECT * FROM posts WHERE id IN ($postIds) ORDER BY FIELD(id, $postIds)"; // 使用 FIELD 函数确保按推荐顺序排序
        } else {
            $postQuery = "SELECT * FROM posts ORDER BY likes DESC, date_added DESC";
        }
    
        $postResult = mysqli_query($con, $postQuery);
    
        if(mysqli_num_rows($postResult) &gt; 0) {
    
            while($post = mysqli_fetch_assoc($postResult)) {
            $userQuery = "SELECT profile_pic FROM users WHERE username = '" . mysqli_real_escape_string($con, $post['added_by']) . "'";
            $userResult = mysqli_query($con, $userQuery);
            $postUser = mysqli_fetch_assoc($userResult);
    
            date_default_timezone_set('America/New_York');
            $dateAdded = new DateTime($post['date_added']);
            $now = new DateTime("now");
            $interval = $dateAdded-&gt;diff($now);
    
            // format date based on the difference
            if ($interval-&gt;h &lt; 1) {
                // less than 1 hour
                if ($interval-&gt;i == 0) {
                    $timeString = 'Just now';
                } else {
                    $timeString = $interval-&gt;i . 'min ago';
                }
            } elseif ($interval-&gt;d &lt; 1) {
                // less than 24 hours but more than 1 hour
                $timeString = $interval-&gt;h . 'h ago';
            } elseif ($interval-&gt;d &lt; 7) {
                // less than 7 days
                $timeString = $interval-&gt;d . 'd ago';
            } else {
                // 7 days or more
                $timeString = $dateAdded-&gt;format('M d, Y');
            }
    
            // check if the vote, flag, like has been clicked
            $flag_query = mysqli_query($con, "SELECT * FROM flags WHERE post_id='{$post['id']}' AND username='{$userLoggedIn}'");
            $flag_icon_class = (mysqli_num_rows($flag_query) &gt; 0) ? "fa" : "far";
    
            $like_query = mysqli_query($con, "SELECT * FROM likes WHERE post_id='{$post['id']}' AND username='{$userLoggedIn}'");
            $like_icon_class = (mysqli_num_rows($like_query) &gt; 0) ? "fa" : "far";
    
            $vote_query = mysqli_query($con, "SELECT * FROM votes WHERE post_id='{$post['id']}' AND username='{$userLoggedIn}'");
            $vote_icon_class = (mysqli_num_rows($vote_query) &gt; 0) ? "fa" : "far";
    
                echo '
                    &lt;div class="card-container" id="post-' . htmlspecialchars($post['id']) . '"&gt;
                        &lt;div class="card-header"&gt;
                            &lt;h2&gt;' . htmlspecialchars($post['title']) . '&lt;/h2&gt;';
    
                // display tags
                if(!empty($post['tags'])) {
                    $tags = explode(',', $post['tags']);
                    foreach($tags as $tag) {
                        echo '&lt;span class="post-tag"&gt;#' . htmlspecialchars(trim($tag)) . '&lt;/span&gt; ';
                    }
                }
    
                echo '
                            &lt;a href="#" class="card-userinfo"&gt;
                                &lt;div class="user-icon"&gt;
                                    &lt;img src="' . htmlspecialchars($postUser['profile_pic']) . '" alt="" /&gt;
                                &lt;/div&gt;
                                &lt;span&gt;' . htmlspecialchars($post['added_by']) . '&lt;/span&gt;
                                &lt;span&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;
                                &lt;span class="post-date" style="color:#b1a290"&gt;' . htmlspecialchars($timeString) . '&lt;/span&gt;
                                &lt;span&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;                        
                                &lt;span class="critter-type"&gt;' . htmlspecialchars($post['category']) . '&lt;/span&gt;
                            &lt;/a&gt;
                        &lt;/div&gt;
                        
                        &lt;div class="card-content"&gt;
                            &lt;img src="' . htmlspecialchars($post['imageName']) . '" alt="" class="card-image" /&gt;
                            &lt;div&gt;' . $post['body'] . '&lt;/div&gt;
                        &lt;/div&gt;
                        
                        &lt;div class="card-footer"&gt;
                            &lt;div class="interaction-icons"&gt;   
                            &lt;i class="' . $vote_icon_class . ' fa-thumbs-up" id="vote-icon-' . $post['id'] . '" onclick="toggleVote(' . $post['id'] . ', \'' . $userLoggedIn . '\')"&gt;&lt;/i&gt;
                            &lt;span&gt;' . htmlspecialchars($post['votes']) . ' votes&lt;/span&gt;
                        
                            &lt;i class="' . $flag_icon_class . ' fa-thumbs-down" id="flag-icon-' . $post['id'] . '" onclick="toggleFlag(' . $post['id'] . ', \'' . $userLoggedIn . '\')"&gt;&lt;/i&gt;
                            &lt;span&gt;' . htmlspecialchars($post['flags']) . ' flags&lt;/span&gt;
                        
                            &lt;i class="' . $like_icon_class . ' fa-heart" id="like-icon-' . $post['id'] . '" onclick="toggleLike(' . $post['id'] . ', \'' . $userLoggedIn . '\')"&gt;&lt;/i&gt;
                            &lt;span&gt;' . htmlspecialchars($post['likes']) . '&lt;/span&gt;
                        &lt;/div&gt;';
                            
                            
                if (isset($userLoggedIn) && $userLoggedIn != $post['added_by']) {
                    echo '
                    &lt;div class="tag-add-form"&gt;
                        &lt;form action="/petsphere2/includes/form_handlers/tag_adder.php" method="POST"&gt;
                            &lt;span&gt;#&lt;/span&gt;
                            &lt;input type="hidden" name="post_id" value="' . htmlspecialchars($post['id']) . '"&gt;
                            &lt;input type="text" name="tag" placeholder="Add a tag"&gt;
                            &lt;button type="submit" name="add_tag"&gt;+ Tag&lt;/button&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                    ';
                }
                        
                
                echo '
                    
                    &lt;/div&gt;
                    &lt;/div&gt;
                ';
            }
        } else {
            echo 'No posts found.';
        }
        ?&gt;
              </code></pre>
        </div>
      </section>

      <section id="work">
        <h1 class="h1bold">更多作品</h1>
        <!-- 项目 -->
        <a class="clearstyle" href="./project-vibely-cn.html" target="_blank">
          <div class="project vibely custom-cursor">
            <div class="project-description">
              <h2>Bumble遇见</h2>
              <div class="project-meta">课程项目 - 产品设计</div>
              <p>
                Bumble
                遇见（Vibely）引入交互式地图，促进基于实时地理位置的时效性互动，提升用户在线交友体验并增加转化率。
              </p>
            </div>
            <div class="project-image">
              <img src="./image/hero_vibely.png" alt="Bumble Vibely项目图片" />
            </div>
          </div>
        </a>

        <!-- Project -->
        <a class="clearstyle" href="project-bikelink-cn.html" target="_blank">
          <div class="project bikelink custom-cursor">
            <div class="project-description">
              <h2>链单车（BikeLink Pro）</h2>
              <div class="project-meta">课程项目 - UI设计</div>
              <p>
                BikeLink
                Pro不只是半自动驾驶电动自行车，它代表着全新的骑行体验。我基于以人为本的设计原则，设计了一系列用户界面和交互范例。
              </p>
            </div>
            <div class="project-image">
              <img
                src="./image/hero_bikelink.png"
                alt="BikeLinkPro Project Image"
              />
            </div>
          </div>
        </a>
      </section>
    </main>

    <footer>
      <div class="pattent">
        &copy;仇康化 <span id="current-year">2024</span>
      </div>
      <ul class="contact">
        <li class="contact-item">
          <a href="mailto:kanghua58@gmail.com">电子邮件</a>
        </li>
        <li class="contact-item">
          <a href="https://www.linkedin.com/in/kayqiu">领英</a>
        </li>
        <li class="contact-item">
          <a href="https://www.instagram.com/phawaiice/">Instagram</a>
        </li>
        <li class="contact-item">
          <a href="https://space.bilibili.com/13065669">哔哩哔哩</a>
        </li>
      </ul>
    </footer>
    <script src="main.js"></script>
  </body>
</html>
